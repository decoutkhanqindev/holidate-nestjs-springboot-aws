@startuml
|Người dùng|
start
:Truy cập trang đăng ký;
:Nhập thông tin\n(họ tên, email, mật khẩu);
:Gửi yêu cầu đăng ký;

|Hệ thống|
:Kiểm tra định dạng thông tin;

if (Thông tin hợp lệ?) then (Không)
  :Thông báo lỗi sai định dạng;
  |Người dùng|
  -> Nhập lại thông tin;
else (Có)
  |Hệ thống|
  :Kiểm tra email trong CSDL;

  if (Email đã tồn tại\nvà đã kích hoạt?) then (Có)
    :Thông báo lỗi\ntài khoản đã tồn tại;
    |Người dùng|
    -> Nhập lại thông tin;
  else (Không)
    |Hệ thống|
    :Tạo tài khoản tạm thời;
    :Lưu thông tin vào CSDL;

    |Người dùng|
    :Yêu cầu gửi mã OTP\nxác nhận email;

    |Hệ thống|
    :Tạo mã OTP;
    :Gửi email chứa mã OTP\nđến người dùng;

    |Người dùng|
    :Nhập mã OTP nhận được;

    |Hệ thống|
    :Xác thực mã OTP;

    if (Mã OTP hợp lệ?) then (Không)
      :Thông báo lỗi\nmã OTP không đúng;
      |Người dùng|
      -> Nhập lại mã OTP;
    else (Có)
      |Hệ thống|
      :Kích hoạt tài khoản;
      :Thông báo đăng ký thành công;
    endif
  endif
endif

stop
@enduml
